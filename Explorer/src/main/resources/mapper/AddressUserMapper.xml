<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.github.dadchain.mapper.AddressUserMapper">
  <resultMap id="BaseResultMap" type="com.github.dadchain.model.dao.AddressUser">
    <!--
      WARNING - @mbg.generated
    -->
    <id column="address" jdbcType="CHAR" property="address" />
    <result column="last_faucet" jdbcType="BIGINT" property="lastFaucet" />
  </resultMap>

  <sql id="basicColumns">
    `address` as `address,`
    last_faucet as lastFaucet
  </sql>

  <select id="getUserByAddress" parameterType="java.lang.String" resultMap="BaseResultMap">
    select `address`, `last_faucet`
    from tbl_user
    where address = #{address}
    <if test="lock">
      FOR UPDATE
    </if>

  </select>

  <insert id="createNewUser" parameterType="com.github.dadchain.model.dao.AddressUser">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into tbl_user (`address`, `last_faucet`)
    values (#{address,jdbcType=CHAR}, #{lastFaucet,jdbcType=BIGINT})
  </insert>

  <update id="updateLastFaucet" >
    update tbl_user set last_faucet=#{lastFaucet}
    where `address`=#{address}
  </update>

</mapper>